(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){e.exports={section:"Login_section__1hoyr"}},2:function(e,t,n){e.exports={modalWrapper:"Dashboard_modalWrapper__3CH_s",section:"Dashboard_section__3PTXJ",resultsWrapper:"Dashboard_resultsWrapper__2qv-V",article:"Dashboard_article__1vBQL",articleButtons:"Dashboard_articleButtons__NQh5j",recentArticle:"Dashboard_recentArticle__16vap",imgWrapper:"Dashboard_imgWrapper__seKI4",img:"Dashboard_img__10QjN",ratingField:"Dashboard_ratingField__v5zF5",ratingScale:"Dashboard_ratingScale__2knKo",highlight:"Dashboard_highlight__1payi"}},29:function(e,t,n){e.exports=n(44)},42:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(24),c=n.n(s),o=n(25),u=n(3),i=n(12),l="RECENTARTICLES_ADD",p="RECENTARTICLES_RESET";var h="SEARCH_CALL",m="SEARCH_RESULTS",d="SEARCH_ERROR",f="SEARCH_RESET",g="IN_PROGRESS",E="COMPLETE",v="ERROR";function b(){return{type:f}}function S(e){return function(t){if(e.searchInput){t({type:h});var n="/api/article/".concat(e.searchInput);e.sourceInput&&(n+="/".concat(e.sourceInput)),fetch(n).then(function(e){e.ok&&e.json().then(function(e){e.message?t(O(e.message)):t(function(e){return{type:m,data:e}}(e))}).catch(function(e){return t(O("Oops! We can't find your articles."))})}).catch(function(e){return t(O("Oops! We can't find your articles."))})}}}function O(e){return{type:d,msg:e}}var y="LOGIN_REQUEST",C="LOGIN_SUCCESS",j="LOGIN_FAIL",I="LOGOUT_COMPLETE",_="LOGGED_IN",R="LOGGED_OUT",k="IN_PROGRESS";function w(e){return function(t){t({type:y}),fetch("/find",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(e)}).then(function(e){e.ok&&e.json().then(function(e){e.validate?(localStorage.setItem("idToken",e.token),t(N(e.username))):t({type:j,msg:"User authentication failed."})})})}}function N(e){return{type:C,user:e}}function T(){return function(e){localStorage.removeItem("idToken"),e(b()),e({type:p}),e({type:I})}}var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginStatus:localStorage.getItem("idToken")?_:R},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object.assign({},e,{loginStatus:k,errorMsg:"",currentUser:null});case C:return Object.assign({},e,{loginStatus:_,errorMsg:"",currentUser:t.user});case j:return Object.assign({},e,{loginStatus:R,errorMsg:t.msg,currentUser:null});case"LOGOUT_REQUEST":return Object.assign({},e,{loginStatus:k});case I:return Object.assign({},e,{loginStatus:R,errorMsg:"",currentUser:null});default:return e}},M="CREATEUSER_RESET",L="CREATEUSER_REQUEST",U="CREATEUSER_SUCCESS",D="CREATEUSER_FAIL",P={NONE:"NONE",IN_PROGRESS:"IN_PROGRESS",USER_CREATED:"USER_CREATED",FAILED:"FAILED"};function F(e){return function(t){var n=e.usernameInput,a=e.emailInput,r=e.passwordInput,s=e.passwordFieldsMatch,c=e.validEmail;n.length&&a.length&&r.length>5?s&&c&&(t({type:L,userCreationStatus:P.IN_PROGRESS}),fetch("/createUser",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({username:n,email:a,password:r})}).then(function(e){e.ok&&e.json().then(function(e){e.err?t(x(e.err)):e.validate?(localStorage.setItem("idToken",e.token),t(N(e.username)),t({type:U})):t(x("Database error."))})})):t(x("All fields are required."))}}function x(e){return{type:D,msg:e}}var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{userCreationStatus:P.NONE},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return{userCreationStatus:P.NONE,errorMsg:""};case L:return{userCreationStatus:P.IN_PROGRESS,errorMsg:""};case U:return{userCreationStatus:P.USER_CREATED};case D:return{userCreationStatus:P.FAILED,errorMsg:t.msg};default:return e}},W=n(21),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{results:[],status:E,errorMsg:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{results:[],status:E,errorMsg:""};case h:return{results:[],status:g,errorMsg:""};case m:return Object(W.a)({},e,{results:t.data,status:E});case d:return Object(W.a)({},e,{status:v,errorMsg:t.msg});default:return e}},H="GOT_SOURCES";function J(){return function(e){fetch("/api/sources").then(function(t){t.ok&&t.json().then(function(t){if(t.sources){var n=new Map;t.sources.forEach(function(e){return n.set(e.id,e.name)}),e(function(e){return{type:H,sources:e}}(n))}})})}}var Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.sources;default:return e}},V=n(18),K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:for(var n=0;n<e.length;n++)if(e[n].url===t.article.url)return e;return[t.article].concat(Object(V.a)(e));case p:return[];default:return e}},q="MODAL_SHOW",z="MODAL_HIDE";function Y(){return{type:z}}var X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return{show:!0,source:t.sourceid};case z:return{show:!1,source:null};default:return e}},Z=Object(i.c)({userAuthentication:A,userCreation:G,search:B,sources:Q,recentArticles:K,modal:X}),$=n(5),ee=n(6),te=n(9),ne=n(7),ae=n(8),re=n(45),se=n(47),ce=n(48),oe=function(e){return r.a.createElement("header",null,r.a.createElement("div",{id:"headerText"},"PRESS THE FREEDOM"),e.isLoggedIn&&r.a.createElement("div",null,e.currentUser&&r.a.createElement("span",null,"Welcome, ",e.currentUser,".  "),r.a.createElement("span",{className:"button",onClick:function(){return e.logout()}},"Logout")))},ue=Object(u.b)(function(e){var t=e.userAuthentication.loginStatus===_;return t&&e.userAuthentication.currentUser?{isLoggedIn:t,currentUser:e.userAuthentication.currentUser}:{isLoggedIn:t}},function(e){return{logout:function(){e(T())}}})(oe),ie=n(14),le=n(46),pe=n(15),he=n.n(pe),me=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).state={usernameInput:"",passwordInput:""},n.loginUser=n.props.loginUser.bind(Object(ie.a)(Object(ie.a)(n))),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:he.a.section},r.a.createElement("form",null,r.a.createElement("input",{type:"text",placeholder:"User Email",maxLength:"35",autoComplete:"email",value:this.state.usernameInput,onChange:function(t){return e.setState({usernameInput:t.target.value})}}),r.a.createElement("input",{type:"password",placeholder:"Password",maxLength:"14",autoComplete:"current-password",value:this.state.passwordInput,onChange:function(t){return e.setState({passwordInput:t.target.value})}}),r.a.createElement("div",null,r.a.createElement("span",{className:"button",onClick:function(t){return e.loginUser(e.state)}},r.a.createElement("span",{className:this.props.buttonClass},this.props.buttonText)),r.a.createElement("span",{className:"button",onClick:function(t){return e.props.history.push("/signup")}},"Create Account"))),this.props.loginStatus===_&&r.a.createElement(le.a,{to:"/home"}),this.props.errorMsg&&r.a.createElement("div",{className:"msg"},this.props.errorMsg))}}]),t}(r.a.Component),de=Object(u.b)(function(e){var t=e.userAuthentication,n=t.loginStatus;return{loginStatus:n,errorMsg:t.errorMsg,buttonText:n===k?"\u25cc":"Login"}},function(e){return{loginUser:function(t){t.usernameInput&&t.passwordInput&&e(w({email:t.usernameInput,password:t.passwordInput}))}}})(me),fe=function(e){function t(){var e;return Object($.a)(this,t),(e=Object(te.a)(this,Object(ne.a)(t).call(this))).state={usernameInput:"",emailInput:"",passwordInput:"",confirmPasswordInput:"",passwordFieldsMatch:!0,passwordLongEnough:!0,validEmail:!0},e}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){this.props.reset()}},{key:"componentDidUpdate",value:function(){this.props.userCreationStatus===P.USER_CREATED&&this.props.history.push("/signin")}},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:he.a.section},r.a.createElement("div",null,"Welcome! Please complete all fields."),r.a.createElement("form",null,r.a.createElement("input",{type:"text",placeholder:"Your name",maxLength:"20",autoComplete:"fname",value:this.state.usernameInput,onChange:function(t){return e.setState({usernameInput:t.target.value})}}),r.a.createElement("input",{type:"text",placeholder:"Email Address",maxLength:"35",autoComplete:"email",value:this.state.emailInput,onChange:function(t){e.setState({emailInput:t.target.value,validEmail:!t.target.value.length||/.+@.+\..+/.test(t.target.value)})}}),r.a.createElement("input",{type:"password",placeholder:"Password",maxLength:"12",autoComplete:"new-password",value:this.state.passwordInput,onChange:function(t){e.setState({passwordInput:t.target.value,passwordFieldsMatch:t.target.value===e.state.confirmPasswordInput,passwordLongEnough:!t.target.value.length||t.target.value.length>5})}}),r.a.createElement("input",{type:"password",placeholder:"Confirm Password",maxLength:"12",autoComplete:"new-password",value:this.state.confirmPasswordInput,onChange:function(t){e.setState({confirmPasswordInput:t.target.value,passwordFieldsMatch:t.target.value===e.state.passwordInput})}}),r.a.createElement("div",{className:"msg"},!this.state.passwordFieldsMatch&&r.a.createElement("span",null,"Password fields must match."),!this.state.passwordLongEnough&&r.a.createElement("span",null,"Password must be at least 6 characters long."),!this.state.validEmail&&r.a.createElement("span",null,"Please enter a valid email address.")),r.a.createElement("div",null,r.a.createElement("span",{className:"button",onClick:function(t){return e.props.createAccount(e.state)}},this.props.buttonText),r.a.createElement("span",{className:"button",onClick:function(t){return e.props.history.push("/signin")}},"Back to Login"))),this.props.errorMsg&&r.a.createElement("div",{className:"msg"},this.props.errorMsg))}}]),t}(r.a.Component),ge=Object(u.b)(function(e){var t=e.userCreation,n=t.userCreationStatus;return{userCreationStatus:n,errorMsg:t.errorMsg,buttonText:n===P.IN_PROGRESS?"\u25cc":"Create Account"}},function(e){return{createAccount:function(t){e(F(t))},reset:function(){e({type:M})}}})(fe),Ee=n(28),ve=n(2),be=n.n(ve),Se=function(e){var t=!1;return e.article.source&&(t=e.sourcesMap.get(e.article.source)),r.a.createElement("div",{className:be.a.article},r.a.createElement("div",null,r.a.createElement("span",null,e.article.title,t&&r.a.createElement("i",null," (",t,")"))),r.a.createElement("div",{className:be.a.articleButtons},r.a.createElement("span",{className:"button",onClick:function(t){e.rateArticle(e.article.source),e.addToRecentArticles(e.article)}},"Rate"),r.a.createElement("a",{href:e.article.url,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("span",{className:"button",onClick:function(t){e.addToRecentArticles(e.article)}},"Go \u279a"))))},Oe=Object(u.b)(function(e){return{sourcesMap:e.sources}},function(e){return{addToRecentArticles:function(t){e(function(e){return{type:l,article:e}}(t))},rateArticle:function(t){e(function(e){return{type:q,sourceid:e}}(t))}}})(Se),ye=function(e){var t=e.results.map(function(e,t){return r.a.createElement(Oe,{article:e,key:t})});return r.a.createElement("div",{className:be.a.resultsWrapper},t)},Ce=function(e){function t(){var e;return Object($.a)(this,t),(e=Object(te.a)(this,Object(ne.a)(t).call(this))).state={searchInput:"",sourceInput:""},e}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"getOptions",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var s,c=this.props.sources[Symbol.iterator]();!(t=(s=c.next()).done);t=!0){var o=s.value,u=Object(Ee.a)(o,2),i=u[0],l=u[1];e.push(r.a.createElement("option",{value:i,key:i},l))}}catch(p){n=!0,a=p}finally{try{t||null==c.return||c.return()}finally{if(n)throw a}}return e}},{key:"componentDidMount",value:function(){this.props.getSources()}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.clickSearch(this.state),this.setState({searchInput:""})}},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:be.a.section},r.a.createElement("h2",null,"Search for Articles"),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("div",null,r.a.createElement("input",{type:"text",placeholder:"Keywords",value:this.state.searchInput,onChange:function(t){e.setState({searchInput:t.target.value})}})),r.a.createElement("div",null,r.a.createElement("select",{onChange:function(t){e.setState({sourceInput:t.target.options[t.target.options.selectedIndex].value})}},[r.a.createElement("option",{value:"",key:0},"News Source (optional)")].concat(Object(V.a)(this.getOptions())))),r.a.createElement("div",{className:"button",onClick:function(t){return e.handleSubmit(t)}},"Search")),this.props.searchStatus===g&&r.a.createElement("div",null,"Searching..."),Boolean(this.props.searchResults.length)&&r.a.createElement(ye,{results:this.props.searchResults}))}}]),t}(r.a.Component),je=Object(u.b)(function(e){return{searchResults:e.search.results,searchStatus:e.search.status,sources:e.sources}},function(e){return{getSources:function(){e(J())},clickSearch:function(t){t.searchInput&&e(S(t))},reset:function(){e(b())}}})(Ce),Ie=function(e){return r.a.createElement("section",{className:be.a.section},r.a.createElement("h2",null,"Top Sources"))},_e=Object(u.b)(function(e){return{}},function(e){return{}})(Ie),Re=function(e){var t=e.articles.map(function(e,t){return r.a.createElement("div",{className:be.a.recentArticle,key:t},r.a.createElement("div",{className:be.a.imgWrapper},r.a.createElement("img",{className:be.a.img,src:e.urlToImage,alt:"article"})),r.a.createElement(Oe,{article:e}))});return t.length>3&&(t=t.slice(0,3)),r.a.createElement("section",{className:be.a.section},r.a.createElement("h2",null,"Your Recent Articles"),r.a.createElement("div",null,t))},ke=Object(u.b)(function(e){return{articles:e.recentArticles}},function(e){return{}})(Re),we=function(e){function t(){return Object($.a)(this,t),Object(te.a)(this,Object(ne.a)(t).apply(this,arguments))}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"highlight",value:function(e){return this.props.currentValue>=e?be.a.highlight:""}},{key:"handleClick",value:function(e,t){this.props.ratingClick(t)}},{key:"render",value:function(){for(var e=this,t=[],n=function(n){t.push(r.a.createElement("span",{className:e.highlight(n),onClick:function(t){return e.handleClick(t,n)},key:n},n))},a=1;a<=10;a++)n(a);return r.a.createElement("div",{className:be.a.ratingScale},t)}}]),t}(r.a.Component),Ne=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(te.a)(this,Object(ne.a)(t).call(this,e))).state={source:e.source,credible:0,accurate:0,relevant:0},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:be.a.modalWrapper},r.a.createElement("section",{className:be.a.section},r.a.createElement("h2",null,"Rate This Article"),r.a.createElement("div",{className:be.a.ratingField},r.a.createElement("span",null,"This article is ",r.a.createElement("b",null,"credible"),"."),r.a.createElement(we,{category:"credible",currentValue:this.state.credible,ratingClick:function(t){return e.setState({credible:t})}})),r.a.createElement("div",{className:be.a.ratingField},r.a.createElement("span",null,"This article is ",r.a.createElement("b",null,"accurate"),"."),r.a.createElement(we,{category:"accurate",currentValue:this.state.accurate,ratingClick:function(t){return e.setState({accurate:t})}})),r.a.createElement("div",{className:be.a.ratingField},r.a.createElement("span",null,"This article is ",r.a.createElement("b",null,"relevant"),"."),r.a.createElement(we,{category:"relevant",currentValue:this.state.relevant,ratingClick:function(t){return e.setState({relevant:t})}})),r.a.createElement("div",null,r.a.createElement("span",{className:"button",onClick:function(t){e.props.submitRating(e.state)}},"Submit Rating"),r.a.createElement("span",{className:"button",onClick:function(t){e.props.closeModal()}},"Cancel"))))}}]),t}(r.a.Component),Te=Object(u.b)(function(e){return{source:e.modal.source}},function(e){return{closeModal:function(){e(Y())},submitRating:function(t){var n;e((n=t,function(e){fetch("/api/srating",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){t.ok?t.json().then(function(t){e(Y())}).catch(function(e){return console.log(e)}):e(void 0)}).catch(function(e){return console.log(e)})}))}}})(Ne),Ae=function(e){function t(){return Object($.a)(this,t),Object(te.a)(this,Object(ne.a)(t).apply(this,arguments))}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("idToken");fetch("/auth",{headers:{Authorization:"Bearer ".concat(t)}}).then(function(t){t.ok&&t.json().then(function(t){"200"!==t.status&&e.props.verifyTokenFailed()}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(je,null),Boolean(this.props.topSources.length)&&r.a.createElement(_e,null),Boolean(this.props.recentArticles.length)&&r.a.createElement(ke,null),this.props.showModal&&r.a.createElement(Te,null))}}]),t}(r.a.Component),Me=Object(u.b)(function(e){return{recentArticles:e.recentArticles,topSources:[],showModal:e.modal.show}},function(e){return{verifyTokenFailed:function(){e(T())}}})(Ae),Le=(n(42),function(e){function t(){return Object($.a)(this,t),Object(te.a)(this,Object(ne.a)(t).apply(this,arguments))}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(ue,null),r.a.createElement("main",null,r.a.createElement(re.a,null,r.a.createElement(se.a,null,r.a.createElement(ce.a,{path:"/signin",component:de}),r.a.createElement(ce.a,{path:"/signup",component:ge}),r.a.createElement(ce.a,{path:"/",component:function(e){var t=function(t){function n(){return Object($.a)(this,n),Object(te.a)(this,Object(ne.a)(n).apply(this,arguments))}return Object(ae.a)(n,t),Object(ee.a)(n,[{key:"render",value:function(){return this.props.loginStatus===_?r.a.createElement(e,null):r.a.createElement(le.a,{to:"/signin"})}}]),n}(r.a.Component);return Object(u.b)(function(e){return{loginStatus:e.userAuthentication.loginStatus}},function(e){return{}})(t)}(Me)})))),r.a.createElement("div",{id:"background"}))}}]),t}(r.a.Component)),Ue=Object(i.d)(Z,Object(i.a)(o.a));c.a.render(r.a.createElement(u.a,{store:Ue},r.a.createElement(Le,null)),document.getElementById("root"))}},[[29,2,1]]]);
//# sourceMappingURL=main.0897aeee.chunk.js.map